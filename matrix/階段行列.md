## 階段行列

### 定義

階段行列（Row Echelon Form）は次の条件を満たす行列です：

1. すべてのゼロ行（要素がすべて 0 の行）は行列の下部に集まっている
2. 各行の先頭の非ゼロ要素（主成分）は、前の行の主成分よりも右側にある
3. 主成分の下の要素はすべて 0 である

### 簡約階段行列

簡約階段行列（Reduced Row Echelon Form, RREF）は階段行列の条件に加えて：

1. 各行の主成分は 1 である
2. 各主成分の列において、主成分以外の要素はすべて 0 である

### 階段行列への変形手順

1. 最左の非ゼロ列を見つける
2. その列の一番上の非ゼロ要素を含む行を第 1 行と交換する
3. 第 1 行の倍数を他の行から引いて、その列の他の要素をすべて 0 にする
4. 第 1 行を無視して、残りの部分行列に対して同じ操作を繰り返す

## 階段行列の例題

### 例題 1: 行列を階段形に変形する

行列 $A = \begin{pmatrix} 2 & 4 & -2 & 6 \\ 3 & 9 & -5 & 15 \\ 1 & 2 & 2 & 5 \end{pmatrix}$ を階段形に変形する。

**ステップ 1**: 第 1 列の主成分を見つける（最初の非ゼロ要素）

$$
\begin{pmatrix}
2 & 4 & -2 & 6 \\
3 & 9 & -5 & 15 \\
1 & 2 & 2 & 5
\end{pmatrix}
$$

**ステップ 2**: 第 1 行と第 3 行を交換する必要はない（第 1 行の要素は既に非ゼロ）

**ステップ 3**: 第 1 行を 1/2 倍して主成分を 1 にする

$$
\begin{pmatrix}
1 & 2 & -1 & 3 \\
3 & 9 & -5 & 15 \\
1 & 2 & 2 & 5
\end{pmatrix}
$$

**ステップ 4**: 第 1 列の他の要素を 0 にする

- 第 2 行から第 1 行の 3 倍を引く
- 第 3 行から第 1 行を引く
  $$
  \begin{pmatrix}
  1 & 2 & -1 & 3 \\
  0 & 3 & -2 & 6 \\
  0 & 0 & 3 & 2
  \end{pmatrix}
  $$

**ステップ 5**: 第 2 列の主成分を 1 にする（第 2 行を 1/3 倍）

$$
\begin{pmatrix}
1 & 2 & -1 & 3 \\
0 & 1 & -2/3 & 2 \\
0 & 0 & 3 & 2
\end{pmatrix}
$$

**ステップ 6**: 第 2 列の他の要素を 0 にする（第 1 行から第 2 行の 2 倍を引く）

$$
\begin{pmatrix}
1 & 0 & 1/3 & -1 \\
0 & 1 & -2/3 & 2 \\
0 & 0 & 3 & 2
\end{pmatrix}
$$

**ステップ 7**: 第 3 列の主成分を 1 にする（第 3 行を 1/3 倍）

$$
\begin{pmatrix}
1 & 0 & 1/3 & -1 \\
0 & 1 & -2/3 & 2 \\
0 & 0 & 1 & 2/3
\end{pmatrix}
$$

**ステップ 8**: 第 3 列の他の要素を 0 にする

- 第 1 行から第 3 行の 1/3 倍を引く
- 第 2 行に第 3 行の 2/3 倍を足す
  $$
  \begin{pmatrix}
  1 & 0 & 0 & -7/3 \\
  0 & 1 & 0 & 8/3 \\
  0 & 0 & 1 & 2/3
  \end{pmatrix}
  $$

これで簡約階段行列の形になりました。

### 例題 2: 線形方程式を解く

線形方程式系
$\begin{cases}
x + 2y + 3z = 9 \\
2x + 5y + 10z = 26 \\
3x + 7y + 18z = 40
\end{cases}$
を掃き出し法で解く。

**ステップ 1**: 係数行列と定数ベクトルからなる拡大行列を作る

$$
\left(
\begin{array}{ccc|c}
1 & 2 & 3 & 9 \\
2 & 5 & 10 & 26 \\
3 & 7 & 18 & 40
\end{array}
\right)
$$

**ステップ 2**: 第 1 列の他の要素を 0 にする

- 第 2 行から第 1 行の 2 倍を引く
- 第 3 行から第 1 行の 3 倍を引く
  $$
  \left(
  \begin{array}{ccc|c}
  1 & 2 & 3 & 9 \\
  0 & 1 & 4 & 8 \\
  0 & 1 & 9 & 13
  \end{array}
  \right)
  $$

**ステップ 3**: 第 2 列の他の要素を 0 にする（第 3 行から第 2 行を引く）

$$
\left(
\begin{array}{ccc|c}
1 & 2 & 3 & 9 \\
0 & 1 & 4 & 8 \\
0 & 0 & 5 & 5
\end{array}
\right)
$$

**ステップ 4**: 第 3 列の主成分を 1 にする（第 3 行を 1/5 倍）

$$
\left(
\begin{array}{ccc|c}
1 & 2 & 3 & 9 \\
0 & 1 & 4 & 8 \\
0 & 0 & 1 & 1
\end{array}
\right)
$$

**ステップ 5**: 第 3 列の他の要素を 0 にする

- 第 1 行から第 3 行の 3 倍を引く
- 第 2 行から第 3 行の 4 倍を引く
  $$
  \left(
  \begin{array}{ccc|c}
  1 & 2 & 0 & 6 \\
  0 & 1 & 0 & 4 \\
  0 & 0 & 1 & 1
  \end{array}
  \right)
  $$

**ステップ 6**: 第 2 列の第 1 行の要素を 0 にする（第 1 行から第 2 行の 2 倍を引く）

$$
\left(
\begin{array}{ccc|c}
1 & 0 & 0 & -2 \\
0 & 1 & 0 & 4 \\
0 & 0 & 1 & 1
\end{array}
\right)
$$

したがって、解は $x = -2$, $y = 4$, $z = 1$ です。
